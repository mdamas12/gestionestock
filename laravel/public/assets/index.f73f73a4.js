import{_ as p,J as h,U as y,S as m,f as i,L as n,F as C,R as d,ab as f,O as b}from"./index.a2d46050.js";import{Q as u,a as V}from"./QCard.9f1b9e44.js";import{Q as v,a as D,b as k,c as Q}from"./QCardActions.59b839eb.js";import{Q as q}from"./scroll.4b111f6a.js";import{Q as w}from"./QPage.b2916cef.js";import{api as g}from"./axios.68f5f38e.js";import"./QItem.ae415059.js";const E={data(){return{searchQuery:"",category:[],categories:[],categories_list:[],dialogVisible:!1,isEditMode:!1,CategoryDataData:{},columns:[{name:"name",label:"Name",align:"left",field:e=>e.name},{name:"description",label:"Description",align:"left",field:e=>e.description},{name:"status",label:"Estado",align:"left",field:e=>e.status==1?"Activo":"Inactivo"},{name:"actions",label:"Actions",align:"center"}],pagination:{rowsPerPage:5}}},computed:{},methods:{loadCategories(){var a,r;let e="Bearer "+localStorage.getItem("authToken");try{g.get("/api/categories",{headers:{Authorization:e}}).then(s=>{this.categories_list=s.data.data})}catch(s){this.$q.notify({type:"negative",message:((r=(a=s.response)==null?void 0:a.data)==null?void 0:r.message)||"Error al recibir categorias."})}},openCreateDialog(){this.isEditMode=!1,this.branchData={name:"",address:""},this.dialogVisible=!0},editCategory(e){this.category=e,this.isEditMode=!0,this.CategoryData={...e},this.dialogVisible=!0},closeDialog(){this.dialogVisible=!1},saveCategory(){var r,s,o,l;let e="Bearer "+localStorage.getItem("authToken"),a={name:this.CategoryData.name,description:this.CategoryData.description,status:1};if(this.isEditMode)try{g.put("/api/categories/"+this.category.id,a,{headers:{Authorization:e}}).then(t=>{this.$q.notify({type:"prositive",message:"Categoria Actualizada"}),this.dialogVisible=!1,this.loadCategories()})}catch(t){this.$q.notify({type:"negative",message:((s=(r=t.response)==null?void 0:r.data)==null?void 0:s.message)||"Error al Actualizar Sucursal"})}else try{g.post("/api/categories/",a,{headers:{Authorization:e}}).then(t=>{this.$q.notify({type:"prositive",message:"Categoria Registrada"}),this.dialogVisible=!1,this.loadCategories()})}catch(t){this.$q.notify({type:"negative",message:((l=(o=t.response)==null?void 0:o.data)==null?void 0:l.message)||"Error al Actualizar Sucursal"})}},deleteCategory(e){let a="Bearer "+localStorage.getItem("authToken");try{g.delete("/api/categories/"+e.id,{headers:{Authorization:a}}).then(r=>{const s=this.categories_list.findIndex(o=>o.id===e.id);s!==-1&&this.categories_list.splice(s,1),this.$q.notify({type:"positive",message:"Categoria ha sido eliminada"})})}catch{alert("La categoria no puede ser eliminada si esta asignada a un producto")}}},mounted(){this.loadCategories()}},A={class:"text-h6"};function _(e,a,r,s,o,l){return h(),y(C,null,[a[6]||(a[6]=m("h5",{class:"q-ml-md"},"Categorias de productos",-1)),i(w,{class:"custon-page"},{default:n(()=>[i(d,{onClick:l.openCreateDialog,label:"Nueva Categoria",color:"primary",class:"q-mb-md"},null,8,["onClick"]),i(u,{modelValue:o.searchQuery,"onUpdate:modelValue":a[0]||(a[0]=t=>o.searchQuery=t),label:"Buscar Categoria",debounce:"300",class:"q-mb-md",onKeydown:a[1]||(a[1]=f(t=>e.searchBranch(),["enter"]))},null,8,["modelValue"]),i(v,{rows:o.categories_list,columns:o.columns,"row-key":"id",pagination:o.pagination,onRequest:l.loadCategories,"rows-per-page-options":[5,10,15]},{"body-cell-actions":n(t=>[i(D,{props:t},{default:n(()=>[i(d,{flat:"",label:"Edit",color:"primary",onClick:c=>l.editCategory(t.row)},null,8,["onClick"]),i(d,{flat:"",label:"Delete",color:"negative",onClick:c=>l.deleteCategory(t.row)},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","pagination","onRequest"]),i(k,{modelValue:o.dialogVisible,"onUpdate:modelValue":a[5]||(a[5]=t=>o.dialogVisible=t),style:{width:"50%",height:"50%"}},{default:n(()=>[i(V,null,{default:n(()=>[i(q,null,{default:n(()=>[m("div",A,b(o.isEditMode?"Editar Categoria":"Crear Categoria"),1),i(u,{modelValue:e.CategoryData.name,"onUpdate:modelValue":a[2]||(a[2]=t=>e.CategoryData.name=t),label:"Nombre",required:""},null,8,["modelValue"]),i(u,{modelValue:e.CategoryData.description,"onUpdate:modelValue":a[3]||(a[3]=t=>e.CategoryData.description=t),label:"Descripcion",required:""},null,8,["modelValue"])]),_:1}),i(Q,null,{default:n(()=>[i(d,{flat:"",label:"Cancel",onClick:l.closeDialog},null,8,["onClick"]),i(d,{flat:"",label:"Guardar",color:"primary",onClick:a[4]||(a[4]=t=>l.saveCategory(e.row))})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})],64)}var U=p(E,[["render",_]]);export{U as default};
